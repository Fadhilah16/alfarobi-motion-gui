<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous"> -->
    <link
      href="./bootstrap-5.0.2-dist\css\bootstrap.min.css"
      rel="stylesheet"
      crossorigin="anonymous"
    />
    <link href="./style.css" rel="stylesheet" crossorigin="anonymous" />

    <!-- <script type="text/javascript" src="./roslib.min.js" ></script> -->
    <script type="text/javascript" src="./roslib.js" ></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/roslibjs/1.1.0/roslib.min.js" integrity="sha512-x2Owc9WayRcRj80Znkau58shVfXN2OIX+gQAlrx6KPugZBKrIC6AwgEWQQCI06p2Q8RB4ilxD+y+1BdNd+1fQA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script> -->
    <script type="text/javascript" src="./jquery-3.6.0.min.js"></script>
    <title>ALFAROBI MOTION</title>
  </head>

  <body>
    <nav class="navbar navbar-light bg-light">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">
          <img
            src="/docs/5.0/assets/brand/bootstrap-logo.svg"
            alt=""
            width="30"
            height="24"
            class="d-inline-block align-text-top"
          />
          GUI DEMO
        </a>
      </div>
    </nav>


    <div class="container mt-2">
      <div class="row">
        <div class="card text-white bg-dark mb-3" style="max-width: 18rem">
          <div class="card-header text-center"><h4>MOVE</h4></div>
          <div class="card-body">
           
            <table class="move-table" align="center" style="width:50%;">
              <tbody>
                <tr>
                   <th scope="row">X</th>
                  <td><input type="number" step="0.001" name="x_move" id="x_move" class="Input" value="0.00" /></td>
                </tr>
                <tr>
                  <th scope="row">Y</th>
                  <td><input type="number" step="0.001" name="y_move" id="y_move" class="Input" value="0.00" /></td>
                </tr>
                <tr>
                  <th scope="row">Z</th>
                  <td><input type="number" step="0.001" name="z_move" id="z_move" class="Input" value="0.00" /></td>
                </tr>
      
              </tbody>
            </table>
            <div class="mt-2">
              <button class="btn btn-success " onclick="start()" style="margin-right: 5px !important;" type="submit">START</button>
              <button class="btn btn-danger" onclick="stop()" style="margin-right: 5px !important;" type="submit">STOP</button> 
                <button class="btn btn-warning" onclick="reset()" type="submit">RESET</button>
              </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script> -->
    <script src="./bootstrap-5.0.2-dist/js/bootstrap.bundle.js"></script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
    -->
    <script type="text/javascript">
      //token github
      // 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
      var ros = new ROSLIB.Ros({url: "ws://10.42.0.2:9090"});

      ros.on("connection", function () {
        console.log("Connected to websocket server.");
      });

      ros.on("error", function (error) {
        console.log("Error connecting to websocket server: ", error);
      });

      ros.on("close", function () {
        console.log("Connection to websocket server closed.");
      });

      // Publishing a Topic
      // ------------------

      var set_walking_command = new ROSLIB.Topic({
        ros: ros,
        name: "/robotis/quintic_walk/command",
        messageType: "std_msgs/String",
      });

      var set_walking_param = new ROSLIB.Topic({
        ros: ros,
        name: "/robotis/quintic_walk/set_params",
        messageType: "quintic_walk_msgs/WalkingParam",
      });

      var get_walking_param_client_ = new ROSLIB.Service({
        ros: ros,
        name: "/robotis/quintic_walk/get_params",
        serviceType : "quintic_walk_msgs/GetWalkingParam",
      });

      

      var walking_param_ = new ROSLIB.Param({
        ros : ros,
        name : 'quintic_walk_msgs/WalkingParam'
      });
      // var request = new ROSLIB.ServiceRequest({});
      // get_walking_param_client_.callService(request, function(resp){
      //   console.log(resp.parameters);
        
      // })

      function start() {

        let x_move = Number($('#x_move').val());
        let y_move = Number($('#y_move').val());
        let z_move = Number($('#z_move').val());
        // var request = new ROSLIB.ServiceRequest({

        //   XMove:x_move,
        //   YMove : y_move,
        //   ZMove : z_move,
        // });
        
      // get_walking_param_client_.callService(request, function(resp){
      //   console.log(resp.parameters);
        
      // })

        var request = new ROSLIB.ServiceRequest({});
      get_walking_param_client_.callService(request, function(resp){
        console.log(resp.parameters);
        
      })
        let walking_params = new ROSLIB.Message({

          freq: 1.64999997616,
          doubleSupportRatio: 0.0450000017881,
          footDistance: 0.129999995232,
          footRise: 0.0450000017881,
          footPutDownZOffset: 0.0,
          footPutDownPhase: 1.0,
          footApexPhase: 0.5,
          footOvershootRatio: 0.0500000007451,
          footOvershootPhase: 0.850000023842,
          trunkHeight: 0.375,
          trunkPitch: 0.209439516068,
          trunkPhase: 0.600000023842,
          trunkXOffset: 0.00999999977648,
          trunkYOffset: 0.0,
          trunkSwing: 0.300000011921,
          trunkPause: 0.5,
          trunkXOffsetPCoefForward: 0.5,
          trunkXOffsetPCoefTurn: 0.0,
          trunkPitchPCoefForward: 0.0,
          trunkPitchPCoefTurn: 0.0,
          trunkYOnlyInDoubleSupport: false,
          XMove: x_move,
          YMove: y_move,
          ZMove: z_move,
          mode: '',
          tuning: false,
          D_ANKLE_P_qw: 0.0,
          D_KNEE_qw: 0.0,
          D_HIP_P_qw: 0.0,
          KP_P_qw: 0.0,
          KD_P_qw: 0.0,
          KI_P_qw: 0.0,
          ShoulderGain_qw: 0.0,
          setpointPitch: 1.0,
          pitch_error_tol: 0.0,
          KP_X_qw: 0.0,
          KD_X_qw: 0.0,
          KI_X_qw: 0.0,
          Angle_0: 9.0,
          Angle_1: 7.0,
          Angle_2: 3.0,
          Angle_3: 8.0,
          Angle_4: 10.0,
          KD_0: 0.230000004172,
          KD_1: 0.180000007153,
          KD_2: 0.0,
          KD_3: 0.189999997616,
          KD_4: 0.239999994636,
          Gyro_0: 80.0,
          Gyro_1: 40.0,
          Gyro_2: 0.0,
          Gyro_3: 40.0,
          Gyro_4: 80.0,
          KP_0: 0.300000011921,
          KP_1: 0.20000000298,
          KP_2: 0.0,
          KP_3: 0.10000000149,
          KP_4: 0.300000011921,
                    
            });
      

        let walking_msg = new ROSLIB.Message({
                data: "start",
            });

        set_walking_param.publish(walking_params);
        set_walking_command.publish(walking_msg);
      }

      function stop() {
        let walking_msg = new ROSLIB.Message({
                data: "stop",
            });

        set_walking_command.publish(walking_msg);
      }

      function reset() {
        let default_value = "0.00";

      $('#x_move').val(default_value);
      $('#y_move').val(default_value);
      $('#z_move').val(default_value);
        
      }

    </script>
  </body>
</html>
