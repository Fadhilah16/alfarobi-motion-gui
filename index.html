<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous"> -->
    <link
      href="./bootstrap-5.0.2-dist\css\bootstrap.min.css"
      rel="stylesheet"
      crossorigin="anonymous"
    />
    <link href="./style.css" rel="stylesheet" crossorigin="anonymous" />

    <!-- <script type="text/javascript" src="./roslib.min.js" ></script> -->
    <script type="text/javascript" src="./roslib.js" ></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/roslibjs/1.1.0/roslib.min.js" integrity="sha512-x2Owc9WayRcRj80Znkau58shVfXN2OIX+gQAlrx6KPugZBKrIC6AwgEWQQCI06p2Q8RB4ilxD+y+1BdNd+1fQA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script> -->
    <script type="text/javascript" src="./jquery-3.6.0.min.js"></script>
    <title>ALFAROBI MOTION</title>
  </head>

  <body>
    <nav class="navbar navbar-light bg-light">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">
          <img
            src="/docs/5.0/assets/brand/bootstrap-logo.svg"
            alt=""
            width="30"
            height="24"
            class="d-inline-block align-text-top"
          />
          GUI DEMO
        </a>
      </div>
    </nav>


    <div class="container mt-2">
      <div class="row">
        <div class="card text-white bg-dark mb-3" style="max-width: 18rem">
          <div class="card-header text-center"><h4>MOVE</h4></div>
          <div class="card-body">
           
            <table class="move-table" align="center" style="width:50%;">
              <tbody>
                <tr>
                   <th scope="row">X</th>
                  <td><input type="number" step="0.001" name="x_move" id="x_move" class="Input" value="0.00" /></td>
                </tr>
                <tr>
                  <th scope="row">Y</th>
                  <td><input type="number" step="0.001" name="y_move" id="y_move" class="Input" value="0.00" /></td>
                </tr>
                <tr>
                  <th scope="row">Z</th>
                  <td><input type="number" step="0.001" name="z_move" id="z_move" class="Input" value="0.00" /></td>
                </tr>
      
              </tbody>
            </table>
            <div class="mt-2">
              <button class="btn btn-success " onclick="start()" style="margin-right: 5px !important;" type="submit">START</button>
              <button class="btn btn-danger" onclick="stop()" style="margin-right: 5px !important;" type="submit">STOP</button> 
                <button class="btn btn-warning" onclick="reset()" type="submit">RESET</button>
              </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script> -->
    <script src="./bootstrap-5.0.2-dist/js/bootstrap.bundle.js"></script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
    -->
    <script type="text/javascript">
      
      var ros = new ROSLIB.Ros({url: "ws://10.42.0.2:9090"});

      ros.on("connection", function () {
        console.log("Connected to websocket server.");
      });

      ros.on("error", function (error) {
        console.log("Error connecting to websocket server: ", error);
      });

      ros.on("close", function () {
        console.log("Connection to websocket server closed.");
      });

      // Publishing a Topic
      // ------------------

      var set_walking_command = new ROSLIB.Topic({
        ros: ros,
        name: "/robotis/quintic_walk/command",
        messageType: "std_msgs/String",
      });

      var set_walking_param = new ROSLIB.Topic({
        ros: ros,
        name: "/robotis/quintic_walk/set_params",
        messageType: "quintic_walk_msgs/WalkingParam",
      });

      var get_walking_param_client_ = new ROSLIB.Service({
        ros: ros,
        name: "/robotis/quintic_walk/get_params",
        serviceType : "quintic_walk_msgs/GetWalkingParam",
      });

      // var request = new ROSLIB.ServiceRequest({});
      // get_walking_param_client_.callService(request, function(resp){
      //   current_walking_param_ = resp.parameters;
      // })

      var walking_param_ = new ROSLIB.Param({
        ros : ros,
        name : 'quintic_walk_msgs/WalkingParam'
      });
      
      function start() {

        let x_move = Number($('#x_move').val());
        let y_move = Number($('#y_move').val());
        let z_move = Number($('#z_move').val());

        // walking_param_.freq = 1.64999997616;
        // walking_param_.doubleSupportRatio =  0.0450000017881;
        // walking_param_.footDistance =  0.129999995232;
        // walking_param_.footRise =  0.0450000017881;
        // walking_param_.footPutDownZOffset= 0.0;
        // walking_param_.footPutDownPhase= 1.0;
        // walking_param_.footApexPhase= 0.5;
        // walking_param_.footOvershootRatio= 0.0500000007451;
        // walking_param_.footOvershootPhase= 0.850000023842;
        // walking_param_.trunkHeight= 0.375;
        // walking_param_.trunkPitch= 0.209439516068;
        // walking_param_.trunkPhase= 0.600000023842;
        // walking_param_.trunkXOffset= 0.00999999977648;
        // walking_param_.trunkYOffset= 0.0;
        // walking_param_.trunkSwing= 0.300000011921;
        // walking_param_.trunkPause= 0.5;
        // walking_param_.trunkXOffsetPCoefForward= 0.5;
        // walking_param_.trunkXOffsetPCoefTurn= 0.0;
        // walking_param_.trunkPitchPCoefForward= 0.0;
        // walking_param_.trunkPitchPCoefTurn= 0.0;
        // walking_param_.trunkYOnlyInDoubleSupport= false;
        // walking_param_.mode= '';
        // walking_param_.tuning= false;
        // walking_param_.D_ANKLE_P_qw= 0.0;
        // walking_param_.D_KNEE_qw= 0.0;
        // walking_param_.D_HIP_P_qw= 0.0;
        // walking_param_.KP_P_qw= 0.0;
        // walking_param_.KD_P_qw= 0.0;
        // walking_param_.KI_P_qw= 0.0;
        // walking_param_.ShoulderGain_qw= 0.0;
        // walking_param_.setpointPitch= 1.0;
        // walking_param_.pitch_error_tol= 0.0;
        // walking_param_.KP_X_qw= 0.0;
        // walking_param_.KD_X_qw= 0.0;
        // walking_param_.KI_X_qw= 0.0;
        // walking_param_.Angle_0= 9.0;
        // walking_param_.Angle_1= 7.0;
        // walking_param_.Angle_2= 3.0;
        // walking_param_.Angle_3= 8.0;
        // walking_param_.Angle_4= 10.0;
        // walking_param_.KD_0= 0.230000004172;
        // walking_param_.KD_1= 0.180000007153;
        // walking_param_.KD_2= 0.0;
        // walking_param_.KD_3= 0.189999997616;
        // walking_param_.KD_4= 0.239999994636;
        // walking_param_.Gyro_0= 80.0;
        // walking_param_.Gyro_1= 40.0;
        // walking_param_.Gyro_2= 0.0;
        // walking_param_.Gyro_3= 40.0;
        // walking_param_.Gyro_4= 80.0;
        // walking_param_.KP_0= 0.300000011921;
        // walking_param_.KP_1= 0.20000000298;
        // walking_param_.KP_2= 0.0;
        // walking_param_.KP_3= 0.10000000149;
        // walking_param_.KP_4= 0.300000011921;
        walking_param_.XMove = x_move;
        walking_param_.YMove = y_move;
        walking_param_.ZMove = z_move;
        // console.log(walking_param_);
        // let walking_params = new ROSLIB.Message({

        //       walking_param_,
                    
            // });
          // console.log(walking_params)
        // walking_param_.set({
        //   XMove :x_move,
        //   YMove :y_move,
        //   ZMove :z_move,
        // })
        
        // console.log(walking_param_)
        
        
        // walking_param_.get(function(val){
        //   val.XMove = x_move;
        //   val.YMove = y_move;
        //   val.ZMove = z_move;
        //   console.log(val)
        // });
      

        let walking_msg = new ROSLIB.Message({
                data: "start",
            });

            console.log(walking_param_)
            console.log(walking_msg)
        set_walking_param.publish(walking_param_);
        set_walking_command.publish(walking_msg);
      }

      function stop() {
        let walking_msg = new ROSLIB.Message({
                data: "stop",
            });

        set_walking_command.publish(walking_msg);
      }

      function reset() {
        let default_value = "0.00";

      $('#x_move').val(default_value);
      $('#y_move').val(default_value);
      $('#z_move').val(default_value);
        
      }

    </script>
  </body>
</html>
